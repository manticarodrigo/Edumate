{"version":3,"sources":["../../src/pages/chat/chat.module.ts","../../src/pages/chat/chat.ts"],"names":[],"mappings":"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","file":"17.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { ChatPage } from './chat';\n\n@NgModule({\n  declarations: [\n    ChatPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(ChatPage),\n  ],\n})\nexport class ChatPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/chat/chat.module.ts","import { Component, ViewChild, Input } from '@angular/core';\nimport { IonicPage, NavController, ActionSheetController, AlertController, LoadingController, NavParams, ViewController, Content } from 'ionic-angular';\n// import { Camera, PhotoViewer } from 'ionic-native';\nimport { StatusBar } from '@ionic-native/status-bar';\n\nimport { AuthProvider } from '../../providers/auth/auth';\n\n@IonicPage({\n  name: 'chat'\n})\n@Component({\n  selector: 'page-chat',\n  templateUrl: 'chat.html',\n})\nexport class ChatPage {\n  @ViewChild(Content) content: Content;\n  @Input() contact: any;\n  messages: any;\n  message = {\n    text: '',\n    id: null,\n    senderId: null,\n    createdAt: null\n  };\n  fileMap = {};\n  constructor(\n    private navCtrl: NavController,\n    private navParams: NavParams,\n    private viewCtrl: ViewController,\n    private actionSheetCtrl: ActionSheetController,\n    private alertCtrl: AlertController,\n    private loadingCtrl: LoadingController,\n    private statusBar: StatusBar,\n    private authProvider: AuthProvider\n    ) {\n      this.contact = this.navParams.get('contact');\n\n    \n  }\n\n  ionViewWillLoad() {\n    // this.statusBar.styleDefault();\n  }\n\n  ionViewWillLeave() {\n    // this.statusBar.styleLightContent();\n  }\n\n  fetchMessages() {\n  }\n\n  observeMessages() {\n    \n  }\n\n  scrollToBottom() {\n    console.log(\"Scrolling to bottom!\");\n    let dimensions = this.content.getContentDimensions();\n    if (this.content.getContentDimensions()) {\n      this.content.scrollToBottom(300);\n      // this.content.scrollTo(0, dimensions.scrollHeight, 250); //x, y, ms animation speed\n    } else {\n      console.log(\"Content not loaded\");\n    }\n  }\n\n  dismiss() {\n    this.viewCtrl.dismiss();\n  }\n\n  send() {\n    let self = this;\n    let text = this.message.text.replace(/^\\s+/, '').replace(/\\s+$/, '');\n    if (text !== '') {\n        // text has real content\n        const msgData = {\n          message: {\n            text: self.message.text,\n            id: this.message.id ? this.message.id : Math.ceil(Math.random() * 1000),\n            senderId: this.authProvider.currentUser._id,\n            createdAt: new Date().getTime()\n          }\n        }\n        // this.chatService.send(msgData, (savedToLocal) => {\n        //   self.message = {\n        //       text: '',\n        //       id: null,\n        //       senderId: this.authProvider.currentUser._id,\n        //       createdAt: null\n        //     };\n        // });\n    }\n  }\n\n  fileChanged(event) {\n    // const self = this;\n    // console.log(\"file changed:\");\n    // console.log(event.target.files[0]);\n    // this.imageService.uploadFile(event.target.files[0], this.project)\n    // .then(data => {\n    //   console.log(\"chat component received data:\");\n    //   console.log(data);\n    //   if (!data['exception']) {\n    //     const msgData = {\n    //       message: {\n    //         fileEntryId: data['fileEntryId'],\n    //         id: this.message.id ? this.message.id : Math.ceil(Math.random() * 1000),\n    //         senderId: this.userService.currentUser.userId,\n    //         createdAt: new Date().getTime()\n    //       },\n    //       room: this.project.projectId\n    //     }\n    //     this.chatService.send(msgData, (savedToLocal) => {\n    //       self.message = {\n    //           text: '',\n    //           id: null,\n    //           senderId: this.userService.currentUser.userId,\n    //           createdAt: null\n    //         };\n    //     });\n    //   }\n    // });\n  }\n\n  // showImage(url) {\n  //   PhotoViewer.show(url);\n  // }\n\n  // presentActionSheet() {\n  //   let actionSheet = this.actionSheetCtrl.create({\n  //   title: 'Select Image Source',\n  //   cssClass: 'action-sheet',\n  //   buttons: [\n  //       {\n  //       text: 'Photo Library',\n  //       handler: () => {\n  //           this.takePicture(Camera.PictureSourceType.PHOTOLIBRARY);\n  //       }\n  //       },\n  //       {\n  //       text: 'Camera',\n  //       handler: () => {\n  //           this.takePicture(Camera.PictureSourceType.CAMERA);\n  //       }\n  //       },\n  //       {\n  //       text: 'Cancel',\n  //       role: 'cancel'\n  //       }\n  //   ]\n  //   });\n  //   actionSheet.present();\n  // }\n\n  // takePicture(sourceType) {\n  //   // Create options for the Camera Dialog\n  //   var options = {\n  //       quality: 100,\n  //       destinationType : Camera.DestinationType.DATA_URL,\n  //       sourceType: sourceType,\n  //       allowEdit : true,\n  //       encodingType: Camera.EncodingType.PNG,\n  //       targetWidth: 500,\n  //       targetHeight: 500,\n  //       saveToPhotoAlbum: true,\n  //       correctOrientation: true\n  //   };\n    \n  //   // Get the data of an image\n  //   Camera.getPicture(options).then((imageData) => {\n  //       this.uploadAttachment(imageData);\n  //   }, (error) => {\n  //       console.log(error);\n  //   });\n  // }\n  // uploadAttachment(imageData) {\n  //   console.log('Attach pressed');\n  //   let loading = this.loadingCtrl.create({\n  //       content: 'Uploading image...'\n  //   });\n  //   loading.present();\n  //   this.storageS.uploadAttachmentIn(this.chat.id, imageData).then(url => {\n  //       this.chatS.sendAttachmentTo(this.user, url).then(url => {\n  //           console.log(url);\n  //           loading.dismiss();\n  //           if (this.user.pushId) {\n  //               this.settingsS.fetchUserSettings(this.user).then(settings => {\n  //                   if (settings.messages) {\n  //                       this.pushS.push(this.userS.user.firstName + \" sent an image.\", this.user, 'attachment');\n  //                   }\n  //               }).catch(error => {\n  //                   console.log(error);\n  //               });\n  //           }\n  //       }).catch(error => {\n  //           console.log(error);\n  //           loading.dismiss();\n  //       });\n  //   }).catch(error => {\n  //       console.log(error);\n  //       loading.dismiss();\n  //   });\n  // }\n\n  getTimeStringFrom(timestamp) {\n    let date = new Date(timestamp);\n    date.setDate(date.getDate());\n    var string = date.toString();\n    var stringArr = string.split(\" \");\n    var time = this.tConvert(stringArr[4]);\n\n    let now = new Date();\n    var seconds = Math.floor((now.getTime() - date.getTime()) / 1000);\n    var interval = Math.floor(seconds / 31536000);\n\n    if (interval > 1) {\n      return interval + \" years ago\";\n    } else if (interval == 1) {\n      return interval + \" year ago\";\n    }\n    interval = Math.floor(seconds / 2592000);\n    if (interval > 1) {\n      return interval + \" months ago\";\n    } else if (interval == 1) {\n      return interval + \" month ago\";\n    }\n    interval = Math.floor(seconds / 86400);\n    if (interval >= 1) {\n      if (interval < 5) {\n        let daysAgo = new Date(now);\n        daysAgo.setDate(daysAgo.getDate() - interval);\n        var string = daysAgo.toString();\n        var stringArr = string.split(\" \");\n        var day = stringArr[0];\n        var time = this.tConvert(stringArr[4]);\n        return day + ' ' + time;\n      } else {\n        return interval + \" days ago\";\n      }\n    }\n    interval = Math.floor(seconds / 3600);\n    if (interval >= 1) {\n      return time;\n    }\n    // interval = Math.floor(seconds / 60);\n    // if (interval >= 1) {\n    //   return interval + \" minutes ago\";\n    // }\n    return time;\n  }\n\n  tConvert(time) {\n    // Check correct time format and split into components\n    time = time.toString().match(/^([01]\\d|2[0-3])(:)([0-5]\\d)(:[0-5]\\d)?$/) || [time];\n\n    if (time.length > 1) { // If time format correct\n        time = time.slice (1);  // Remove full string match value\n        time[3] = +time[0] < 12 ? ' AM' : ' PM'; // Set AM/PM\n        time[0] = +time[0] % 12 || 12; // Adjust hours\n    }\n    return time.join (''); // return adjusted time or original string\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/chat/chat.ts"],"sourceRoot":""}